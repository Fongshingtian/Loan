<%--营业网点--%>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>线上预约贷款_中兴财富普惠线上信用贷款平台</title>
	<meta name="Keywords" content="线上贷款,预约贷款,线上信用贷款,线上小额贷款" />
	<meta name="Description" content="中兴财富普惠线上预约贷款平台，全国各地有多个营业部，主要分布于各地省会城市，是国内知名的金融信息在线服务专家" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
<!-- 是否为开发模式 -->
<!-- 资源加载版本号 -->
<!--[if lt IE 9]><script src="https://www.xnph66.com/HomePage/resources/xnph/vender/bootstrap/dist/js/ie8-responsive-file-warning.js"></script><![endif]-->
<script src="/jsp/outlets/HomePage/resources/xnph/vender/bootstrap/dist/js/ie-emulation-modes-warning.js"></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<!-- common -->
	<link rel="stylesheet" type="text/css" href="/jsp/outlets/HomePage/resources/dist/build/build.css?v=2.1.2">
	<link rel="stylesheet" type="text/css" href="/jsp/outlets/HomePage/resources/dist/css/less/branch_style.css">
<!--[if lt IE 9]>
	<script src="http://html5media.googlecode.com/svn/trunk/src/html5media.min.js"></script>
<![endif]-->
<!--头部预先加载js-->
<!-- common -->
	<script type="text/javascript" src="/jsp/outlets/HomePage/resources/dist/build/build.js"></script>
<!-- 百度统计-->
<script type="text/javascript">
var XnphVideoPlaying = function(){console.log('nothing');};
</script>
    <jsp:include page="/WEB-INF/jsp/common/resources.jsp"></jsp:include>
    <jsp:include page="/WEB-INF/jsp/common/top.jsp"></jsp:include>
    <jsp:include page="/WEB-INF/jsp/common/top2.jsp"></jsp:include>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d249a44e45d00944e513d824188f2185";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

var IsPlay = false;
XnphVideoPlaying = function() {

    if(!IsPlay && _hmt){
        _hmt.push(['_trackEvent', 'XNPH_VIDEO', 'play', 'white-collar workers']);
        IsPlay = true;
        console.log('baidu _trackEvent video play');
    }

}
</script>

<!-- https不支持腾讯在线客服js，建议使用图片或者文字超链接发起在线咨询 -->
<!-- <script charset="utf-8" type="text/javascript" src="https://wpa.b.qq.com/cgi/wpa.php"></script> -->
	<style type="text/css">
	.bra-map-title{font-size:14px; margin:50px 0 18px 0; }
	.bra-map-main{  height:500px; border:1px solid #b5b5b5; padding :10px;  background:#fff; text-align:center  }
	.bra-map-con{ height:100%; background:#999; margin-top:14px; border:1px solid #ccc; margin: 0 auto; }
	</style>
</head>
<body>
	<!--头部-->
    <input type="hidden" value="https://www.xnph66.com" id="txt-base-url" />
    <input type="hidden" value="https://www.xnph66.com/HomePage/resources" id="txt-resource-url" />
    <input type="hidden" value="https://website-img.xnph66.com/" id="txt-img-url" />
    <!-- <header>
    <div class="g-m">
        <ul>
            <li class="tel fl">全国服务热线：400-8730-666</li>
            <li class="wechat fr">
                <a href="javascript:;">微信关注我们</a>
                <img class="header-qrcode" src="https://www.xnph66.com/HomePage/resources/xnph/images/header-qrcode.png">
            </li>
            <li class="linkus fr"><a href="https://www.xnph66.com/contact">联系我们</a></li>
        </ul>
    </div>
</header> -->
    <!--右侧停靠 begin-->
    <div class="BizQQWPA_wrap fix-r-area">
        <div class="fra-wrap">
            <a class="f-btn-ic ic-customer-feedback" href="/jsp/user_feedback.htm"></a>
            <!-- <a class="f-btn-ic ic-qq-server" id="BizQQWPA"></a> -->
            <a class="f-btn-ic ic-wechat-server"><i></i></a>
            <a class="f-btn-ic ic-back-top" href="javascript:document.documentElement.scrollTop = document.body.scrollTop = 0;"></a>
        </div>
    </div>
    <!--右侧停靠 end-->

	<div class="box-gry box-paddingb">
	    <div class="crumbs">
	        <a >首页&nbsp</a>&gt;
	        <a>在线预约</a>
	    </div>
	    <div class="body-wrap">
	        <div class="wrap-left fl">
	            <div class="wrap-left-nav">
	                <div class="wrap-left-nav-main">
	                    <ul>
	                        <li  style="height: 50px;" class="current" >
                                <a href="/outlets"  class="block-a">
                                    <span class="l-n-title" >营业网点</span>
                                    <div class="wrap-left-nav-mask"></div>
                                </a>
                            </li>
                            <li class="bg-gray-lter"  style="height: 50px;">
                                <a  class="block-a" >
                                    <span class="l-n-title" >在线预约</span>
                                    <div class="wrap-left-nav-mask" style="display: block"></div>
                                </a>
                            </li>
	                    </ul>
	                </div>
	            </div>
	        </div>
	        <div class="wrap-right fr">
	            <div class="wrap-right-title">
	                在线预约
	            </div>
	            <div class="branch-right-content branch-list-wraper">
	            	<div class="branch-search-area">
	            		<form class="form-inline xn-form" role="form" id="branchSearchForm" action="/outlets">
		                    <div class="form-group m-r-md m-l-xxxl i-b" >
		                        <div class="w-xn-xl i-b">
		                            <select style="border: 1px solid rgba(67,111,5,0.13);width: 300px;height: 38px;cursor: pointer;"  data-width="100%" title="请选择省份或直辖市" name="province" id="province">
                                        <option value="" city="">请选择省份或直辖市</option>
                                        <c:forEach items="${province}" var="p">
                                            <c:choose>
                                                <c:when test="${outlets!=null&&outlets.province==p.province}">
                                                    <option value="${p.province}" city="${p.city}" selected="selected">${p.province}</option>
                                                </c:when>
                                                <c:otherwise>
                                                    <option value="${p.province}" city="${p.city}">${p.province}</option>
                                                </c:otherwise>
                                            </c:choose>
                                        </c:forEach>
		                            </select>
		                        </div>
		                    </div>
		                    <div class="form-group i-b">
		                        <div class="w-xn-xl i-b">
		                            <select style="border: 1px solid rgba(67,111,5,0.13);width: 300px;height: 38px;cursor: pointer"  data-width="100%" title="请选择地区" id="city" name="city">
											<option value="">请选择地区</option>
		                            </select>
		                        </div>
		                    </div>
		                    <div class="form-group i-b">
		                        <div class="w-s m-l-xxl i-b">
		                            <button class="btn btn-orange w-s">查询</button>
		                        </div>
		                    </div>
		                </form>
	            	</div>
	                
	                <div class="branch-list">
	                    <ul>
                            <c:forEach items="${list}" var="l">
	                    		<li class="clearfix branch-li">
		                            <div class="branch-num">${l.name}</div>
		                            <div class="branch-city fl">
		                                <p class="branch-list-title">所在地区：</p>
		                                <p>${l.province}&nbsp; ${l.city}</p>
		                            </div>
		                            <div  class="branch-phone fl">
		                                <p  class="branch-list-title">联系电话：</p>
		                                <p>${l.contactPhone}</p>
		                                <p></p>
		                            </div>
		                            <div class="branch-address fl">
		                                <p  class="branch-list-title">详细地址：</p>
		                                <p>${l.address}</p>
		                            </div>
                                    <input type="hidden" name="longitude" value="${l.longitude}"
                                           data-address="${l.address}" data-tel="${l.contactPhone}"
                                           data-branchName="${l.name}" data-branchid="${l.id}">
                                    <input type="hidden" name="latitude" value="${l.latitude}">
		                            <a class="btn btn-orange w-s" href="/tobooking/${l.id}">预约</a>
		                        </li>
                            </c:forEach>
	                    </ul>
	                </div>
	                <!--分页-->
    <!--分页-->
    <div class="about-page">
      <ul class="pagination">
        <!-- pageNum 当前页码
        pageSize 每页条数class="disabled"
        totalPage 总页数 -->
            <li ><a href="javascript:void(0);" onclick="choosePage(1)">首页</a></li>
            <li><a href="javascript:void(0);" onclick="choosePage(${currpage-1})">&laquo;</a></li>
		    <li class="active"><a href="javascript:;void(0)" >1</a></li>
            <li><a href="javascript:void(0);" onclick="choosePage(${currpage+1})">&raquo;</a></li>
            <li><a href="javascript:void(0);" onclick="choosePage(${totalpage})">末页</a></li>
      </ul>
    </div>
	         		<!-- 地图 -->
	         		<div class="">
	         			<div class="bra-map-title">网点地理位置</div>
	         			<div class="bra-map-main"  >
	         				<div class="bra-map-con" id="map"></div>
	         			</div>
	         		</div>
	            </div>
	        </div>
	        <div class="clearfix" ></div>
	    </div>
	</div>

	<script type="text/templete">

	</script>


<script type="text/javascript" src="https://www.xnph66.com/HomePage/resources/dist/js/about.js"></script>
<script type="text/javascript" src="https://www.xnph66.com/HomePage/resources/dist/js/branch.js"></script>

<!--地图查询-->
<script type="text/javascript">
    var longitudes = $("[name='longitude']");
    var latitudes = $("[name='latitude']");
    var markerArr =[];
    for (var i=0; i< longitudes.length; i++) {
    	var $branchInfo = $(longitudes[i]);
    	markerArr.push({
    		longitude : longitudes[i].value, 
    		latitude: latitudes[i].value,
    		infoHtml : '营业部：' + $branchInfo.attr('data-branchName') + '<a class="text-orange m-l-md" href="https://www.xnph66.com/loanappointment' + $branchInfo.attr('data-branchid') + '">立即预约</a><br>地址：' + $branchInfo.attr('data-address') + '<br>电话：' + $branchInfo.attr('data-tel')
    	});
    }

    function map_init() {
        var map = new BMap.Map("map"); // 创建Map实例
        if(markerArr.length > 0){
            var point = new BMap.Point(markerArr[0].longitude, markerArr[0].latitude); //地图中心点，默认第一个点
        }else{
            var point = new BMap.Point(113.96090200, 22.54604500); //地图中心点，深圳市
        }
        map.centerAndZoom(point, 13); // 初始化地图,设置中心点坐标和地图级别。
        map.enableScrollWheelZoom(true); //启用滚轮放大缩小

        var point = new Array(); //存放标注点经纬信息的数组
        var marker = new Array(); //存放标注点对象的数组
        // var info = new Array(); //存放提示信息窗口对象的数组
        for (var i = 0; i < markerArr.length; i++) {
            var p0 = markerArr[i].longitude; //
            var p1 = markerArr[i].latitude; //按照原数组的point格式将地图点坐标的经纬度分别提出来
            point[i] = new window.BMap.Point(p0, p1); //循环生成新的地图点
            marker[i] = new window.BMap.Marker(point[i]); //按照地图点坐标生成标记
            map.addOverlay(marker[i]);

            var content = markerArr[i].infoHtml;
            addClickHandler(content,marker[i]);
        }

        function addClickHandler(content,marker){
			marker.addEventListener("click",function(e){
				openInfo(content,e)
			});
			marker.addEventListener("mouseover",function(e){
				openInfo(content,e)
			});
		}

		var opts = {
			//width : 250,     // 信息窗口宽度
			//height: 80,     // 信息窗口高度
			title : "营业网点信息" , // 信息窗口标题
			enableMessage:true//设置允许信息窗发送短息
	   	};

		function openInfo(content,e){
			var p = e.target;
			var point = new BMap.Point(p.getPosition().lng, p.getPosition().lat);
			var infoWindow = new BMap.InfoWindow(content,opts);  // 创建信息窗口对象 
			map.openInfoWindow(infoWindow,point); //开启信息窗口
		}

    }
    //异步调用百度js
    function map_load() {
        var load = document.createElement("script");
        load.src = "https://api.map.baidu.com/api?v=2.0&ak=nzxehCoUYossf1GC5v8WFibG79o5h366&callback=map_init&s=1";
        document.body.appendChild(load);
    }

    $(function(){
    	setTimeout(function(){map_load();}, 800);
    })
</script>

<script type="text/javascript">
        $(function(){
            //生成城市
            $("#province").change(function(){
                var province=$(this).val();
                var citys="";
                if(province!=""){
                    citys=$("option[value="+province+"]").attr("city");
                }
                var city=citys.split(",");
                var citySel=$("#city");
                citySel.empty();
                if(citys!=""){
                    for(var i=0;i<city.length;i++){
                        if(city=="${outlets.city}"){
                            citySel.append("<option value='"+city[i]+"' selected>"+city[i]+"</option>");
                        }else{
                            citySel.append("<option value='"+city[i]+"'>"+city[i]+"</option>");
                        }
                    }
                }else{
                    citySel.append("<option value=''>请选择地区</option>");
                }
            });
            //查询后给所城市选中
            if($("#province").val()!=""){
                var province=$("#province").val();
                var citys="";
                if(province!=""){
                    citys=$("option[value="+province+"]").attr("city");
                }
                var city=citys.split(",");
                var citySel=$("#city");
                citySel.empty();
                citySel.append("<option value=''>请选择地区</option>");
                if(citys!=""){
                    for(var i=0;i<city.length;i++){
                        if(city[i]=="${outlets.city}"){
                            citySel.append("<option value='"+city[i]+"' selected>"+city[i]+"</option>");
                        }else{
                            citySel.append("<option value='"+city[i]+"'>"+city[i]+"</option>");
                        }
                    }
                }
            }
        });

        //选页
        function choosePage(currpage){
            var province =$("#province").val();
            var city =$("#city").val();
            var phref="outlets?province="+province+"&city="+city+"&currpage="+currpage;
            window.location.href=phref;
        }
</script>
</body>
<jsp:include page="/WEB-INF/jsp/common/bottom.jsp"></jsp:include>
</html>