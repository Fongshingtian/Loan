!function(e){var a=function(){this.init()};a.prototype={init:function(){this.ui={},this.ui.quotaCalculationForm=e("#quotaCalculationForm"),this.ui.sexSel=e('#quotaCalculationForm select[name="sex"]').eq(0),this.ui.marriageStatusSel=e('#quotaCalculationForm select[name="marriageStatus"]').eq(0),this.ui.lifePolicySel=e('#quotaCalculationForm select[name="lifePolicy"]').eq(0),this.ui.housePropertySel=e('#quotaCalculationForm select[name="houseProperty"]').eq(0),this.ui.socialSecuritySel=e('#quotaCalculationForm select[name="socialSecurity"]').eq(0),this.ui.incomeTypeSel=e('#quotaCalculationForm select[name="incomeType"]').eq(0),this.ui.natureSel=e('#quotaCalculationForm select[name="nature"]').eq(0),this.ui.isCreditCardRadio=e('#quotaCalculationForm input[name="isCreditCard"]'),this.ui.hasCreditCardArea=e("#hasCreditCardArea"),this.ui.creditCardRepayMethodSel=e('#quotaCalculationForm select[name="creditCardRepayMethod"]').eq(0),this.ui.formInpArea=e("#form-inp-area"),this.ui.quotaResultArea=e("#quota-result-area"),this.ui.txtQuotaResult=e("#txt-quota-result"),this.ui.sendCodeModal=e("#quotaCalcul-sendcode-modal"),this.ui.btnSendCode=e("#btn-send-code"),this.ui.txtMobile=e('#sendCodeForm input[name="mobile"]').eq(0),this.ui.btnShowResult=e("#btn-show-result"),this.initData(),this.regEvent(),this.quotaCalculationFormInit(),this.sendCodeFormInit()},initData:function(){new window.PhoneVerifyCode({elBtn:this.ui.btnSendCode,elPhone:this.ui.txtMobile})},regEvent:function(){var a=this;this.ui.isCreditCardRadio.on("change",function(){"0"==e(this).val()?a.ui.hasCreditCardArea.slideDown():a.ui.hasCreditCardArea.slideUp()}),this.ui.sexSel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)}),this.ui.marriageStatusSel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)}),this.ui.lifePolicySel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)}),this.ui.housePropertySel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)}),this.ui.socialSecuritySel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)}),this.ui.incomeTypeSel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)}),this.ui.natureSel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)}),this.ui.creditCardRepayMethodSel.on("changed.bs.select",function(){a.quotaFormValidator.element(this)})},quotaCalculationFormInit:function(){var a=this,t=this.ui.quotaCalculationForm;this.quotaFormValidator=t.validate({rules:{custName:"required",sex:"required",age:{required:!0,number:!0},marriageStatus:"required",lifePolicy:"required",houseProperty:"required",socialSecurity:"required",incomeType:"required",nature:"required",isCreditCard:"required",creditCardAmount:{required:"#radio-has-creditcard:checked"},creditCardRepayMethod:{required:"#radio-has-creditcard:checked"}},messages:{custName:"请输入您的姓名",sex:"请选择性别",age:{required:"请输入年龄",number:"年龄格式不正确"},marriageStatus:"请选择婚姻状况",lifePolicy:"请选择保单类型",houseProperty:"请选择房产类型",houseProperty:"请选择您的社保类型",incomeType:"请选择您的发薪方式",nature:"请选择您所在单位性质",isCreditCard:"请选择信用卡持有情况",creditCardAmount:"请输入信用卡额度",creditCardRepayMethod:"请选择信用卡还款方式"},errorClass:"has-error",errorPlacement:function(a,t){e(t).hasClass("selectpicker")?e(t).parent().parent().parent().find(".xn-error").html(a):"isAgree"==e(t).attr("name")||"isCreditCard"==e(t).attr("name")?e(t).parent().parent().parent().find(".xn-error").html(a):"captcha"==e(t).attr("name")?e(t).parent().parent().find(".xn-error").html(a):e(t).parent().find(".xn-error").html(a)},highlight:function(a,t){e(a).hasClass("selectpicker")?e(a).parent().parent().parent().addClass(t):e(a).hasClass("area-sel")?e(a).parent().parent().addClass(t):"isAgree"==e(a).attr("name")||"isCreditCard"==e(a).attr("name")?e(a).parent().parent().parent().addClass(t):"captcha"==e(a).attr("name")?e(a).parent().parent().addClass(t):e(a).parent().addClass(t)},success:function(a,t){e(t).hasClass("selectpicker")?e(t).parent().parent().parent().removeClass("has-error").addClass("has-success"):e(t).hasClass("area-sel")?e(t).parent().parent().removeClass("has-error"):"isAgree"==e(t).attr("name")||"isCreditCard"==e(t).attr("name")?e(t).parent().parent().parent().removeClass("has-error").addClass("has-success"):"captcha"==e(t).attr("name")?e(t).parent().parent().removeClass("has-error").addClass("has-success"):e(t).parent().removeClass("has-error").addClass("has-success")},submitHandler:function(){t.find(".has-error").removeClass("has-error"),a.ui.sendCodeModal.modal()}})},sendCodeFormInit:function(){var a=this,t=e("#sendCodeForm");this.sendCodeFormValidator=t.validate({rules:{captcha:"required",mobile:{required:!0,isPhone:!0}},messages:{captcha:"请输入手机验证码",mobile:{required:"请输入手机号码",isPhone:"手机号码不正确"}},errorClass:"has-error",errorLabelContainer:t.find("div.error-place"),highlight:function(a,t){e(a).hasClass("selectpicker")?e(a).parent().parent().parent().addClass(t):e(a).hasClass("area-sel")?e(a).parent().parent().addClass(t):"captcha"==e(a).attr("name")?e(a).parent().parent().addClass(t):e(a).parent().addClass(t)},success:function(a,t){e(t).hasClass("selectpicker")?e(t).parent().parent().parent().removeClass("has-error").addClass("has-success"):e(t).hasClass("area-sel")?e(t).parent().parent().removeClass("has-error"):"captcha"==e(t).attr("name")?e(t).parent().parent().removeClass("has-error").addClass("has-success"):e(t).parent().removeClass("has-error").addClass("has-success")},submitHandler:function(){t.find(".has-error").removeClass("has-error");var e=a.ui.quotaCalculationForm.serialize()+"&"+t.serialize();a.ui.btnShowResult.addClass("disabled"),window.API.submitLoanEstimate(e).then(function(e){"1"==e.code?(a.ui.sendCodeModal.modal("hide"),a.ui.formInpArea.hide(),a.ui.txtQuotaResult.html(e.descr),a.ui.quotaResultArea.slideDown()):e.code<=0?(alert(e.msg),a.ui.btnShowResult.removeClass("disabled")):alert("系统异常！")},function(){alert("系统异常！")}).always(function(){a.ui.btnShowResult.removeClass("disabled")})}})}},e(function(){new a})}($);